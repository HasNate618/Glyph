<Window x:Class="Glyph.App.OverlayWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    WindowStyle="None"
    ResizeMode="NoResize"
    Background="Transparent"
    Topmost="True"
    ShowActivated="False"
    Focusable="False"
    ShowInTaskbar="False"
    SizeToContent="WidthAndHeight"
    Title="Glyph Overlay">
    <!-- Single-layer rounded panel only; window background stays transparent -->
    <Border
        Padding="20,14,20,14"
        CornerRadius="{DynamicResource Glyph.Overlay.PanelCornerRadius}"
        Background="{DynamicResource Glyph.Overlay.BackgroundBrush}"
        SnapsToDevicePixels="True">
        <!-- Use system backdrop/shadow where available; avoid WPF DropShadowEffect which can force layered rendering -->

        <StackPanel MinWidth="300" MaxWidth="420">
            <TextBlock
                x:Name="SequenceText"
                Foreground="{DynamicResource Glyph.Overlay.SequenceForeground}"
                FontSize="14"
                FontWeight="SemiBold"
                FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                Margin="0,0,0,8"
                Text="Glyph" />
            <ItemsControl x:Name="OptionsList" Margin="0,2,0,0">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <DockPanel LastChildFill="True" Margin="0,6,0,6">
                            <ItemsControl ItemsSource="{Binding KeyCaps}" DockPanel.Dock="Left" Margin="0,0,8,0">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border MinWidth="28" Height="28" Padding="6,0" CornerRadius="{DynamicResource Glyph.Overlay.KeycapCornerRadius}" Background="{DynamicResource Glyph.Overlay.KeycapBackground}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,0,4,0">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="{DynamicResource Glyph.Overlay.KeycapBackgroundAction}" />
                                                    <Setter Property="BorderBrush" Value="{x:Null}" />
                                                    <Setter Property="BorderThickness" Value="0" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.IsLayer, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                            <Setter Property="Background" Value="{DynamicResource Glyph.Overlay.KeycapBackgroundLayer}" />
                                                        </DataTrigger>

                                                        <DataTrigger Binding="{Binding DataContext.IsAction, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                            <Setter Property="BorderBrush" Value="{DynamicResource Glyph.Overlay.KeycapBorderAction}" />
                                                            <Setter Property="BorderThickness" Value="2" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Viewbox Stretch="Uniform" StretchDirection="DownOnly">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Center"
                                                    FontWeight="Bold"
                                                    FontSize="13"
                                                    Foreground="{DynamicResource Glyph.Overlay.KeycapForegroundAction}"
                                                    FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                                                    Text="{Binding}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Foreground" Value="{DynamicResource Glyph.Overlay.KeycapForegroundAction}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DataContext.IsLayer, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                                    <Setter Property="Foreground" Value="{DynamicResource Glyph.Overlay.KeycapForegroundLayer}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Viewbox>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <TextBlock
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource Glyph.Overlay.OptionForeground}"
                                FontSize="13"
                                FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                                Text="{Binding Description}" />
                        </DockPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Border>
</Window>
