<Window x:Class="Glyph.App.OverlayWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    WindowStyle="None"
    ResizeMode="NoResize"
    Background="Transparent"
    Topmost="True"
    ShowActivated="False"
    Focusable="False"
    ShowInTaskbar="False"
    SizeToContent="WidthAndHeight"
    Title="Glyph Overlay">
    <!-- Single-layer rounded panel only; window background stays transparent -->
    <Border
        Padding="{DynamicResource Glyph.Overlay.PanelPadding}"
        CornerRadius="{DynamicResource Glyph.Overlay.PanelCornerRadius}"
        Background="{DynamicResource Glyph.Overlay.BackgroundBrush}"
        SnapsToDevicePixels="True">
        <!-- Use system backdrop/shadow where available; avoid WPF DropShadowEffect which can force layered rendering -->

        <StackPanel MinWidth="{DynamicResource Glyph.Overlay.PanelMinWidth}" MaxWidth="{DynamicResource Glyph.Overlay.PanelMaxWidth}">
            <TextBlock
                x:Name="SequenceText"
                Foreground="{DynamicResource Glyph.Overlay.SequenceForeground}"
                FontSize="{DynamicResource Glyph.Overlay.SequenceFontSize}"
                FontWeight="SemiBold"
                FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                Margin="{DynamicResource Glyph.Overlay.SequenceMargin}"
                Text="Glyph" />
            <ItemsControl x:Name="OptionsList" Margin="{DynamicResource Glyph.Overlay.OptionsMargin}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <DockPanel LastChildFill="True" Margin="{DynamicResource Glyph.Overlay.OptionRowMargin}">
                            <ItemsControl ItemsSource="{Binding KeyCaps}" DockPanel.Dock="Left" Margin="{DynamicResource Glyph.Overlay.OptionKeycapsMargin}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border MinWidth="{DynamicResource Glyph.Overlay.KeycapMinWidth}" Height="{DynamicResource Glyph.Overlay.KeycapHeight}" Padding="{DynamicResource Glyph.Overlay.KeycapPadding}" CornerRadius="{DynamicResource Glyph.Overlay.KeycapCornerRadius}" Background="{DynamicResource Glyph.Overlay.KeycapBackground}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="{DynamicResource Glyph.Overlay.KeycapMargin}">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="{DynamicResource Glyph.Overlay.KeycapBackgroundAction}" />
                                                    <Setter Property="BorderBrush" Value="{x:Null}" />
                                                    <Setter Property="BorderThickness" Value="0" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.IsLayer, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                            <Setter Property="Background" Value="{DynamicResource Glyph.Overlay.KeycapBackgroundLayer}" />
                                                        </DataTrigger>

                                                        <DataTrigger Binding="{Binding DataContext.IsAction, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                            <Setter Property="BorderBrush" Value="{DynamicResource Glyph.Overlay.KeycapBorderAction}" />
                                                            <Setter Property="BorderThickness" Value="{DynamicResource Glyph.Overlay.KeycapBorderThickness}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Viewbox Stretch="Uniform" StretchDirection="DownOnly">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Center"
                                                    FontWeight="Bold"
                                                    FontSize="{DynamicResource Glyph.Overlay.KeycapFontSize}"
                                                    Foreground="{DynamicResource Glyph.Overlay.KeycapForegroundAction}"
                                                    FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                                                    Text="{Binding}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Foreground" Value="{DynamicResource Glyph.Overlay.KeycapForegroundAction}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DataContext.IsLayer, RelativeSource={RelativeSource AncestorType=ItemsControl}}" Value="True">
                                                                    <Setter Property="Foreground" Value="{DynamicResource Glyph.Overlay.KeycapForegroundLayer}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Viewbox>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <TextBlock
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource Glyph.Overlay.OptionForeground}"
                                FontSize="{DynamicResource Glyph.Overlay.OptionDescriptionFontSize}"
                                FontFamily="{DynamicResource Glyph.Overlay.FontFamily}"
                                Text="{Binding Description}" />
                        </DockPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Border>
</Window>
