<ui:FluentWindow x:Class="Glyph.App.UI.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:svgc="clr-namespace:SharpVectors.Converters;assembly=SharpVectors.Converters.Wpf"
        Title="Glyph Settings" Height="860" Width="820"
        WindowStartupLocation="CenterScreen"
        ExtendsContentIntoTitleBar="True">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Title bar with back button -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <ui:Button x:Name="BackButton" Grid.Column="0"
                       Visibility="Collapsed"
                       Appearance="Secondary"
                       Padding="8,4"
                       Margin="8,0,0,0"
                       Click="BackButton_Click"
                       Icon="{ui:SymbolIcon ArrowLeft24}"
                       ToolTip="Back to Settings" />
            <ui:TitleBar Grid.Column="1" Title="" />
        </Grid>

        <!-- Content area - switches between general settings and keymap editor -->
        <ContentControl x:Name="ContentArea" Grid.Row="1">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="24,0" x:Name="GeneralSettingsScrollViewer">
                <StackPanel Margin="0,12,0,24" x:Name="GeneralSettingsPanel">
                    <!-- Header with SVG logo -->
                    <svgc:SvgViewbox x:Name="HeaderLogo"
                                    Source="pack://application:,,,/Glyph.App;component/Assets/LogoTextBlack.svg"
                                    Height="98"
                                    Stretch="Uniform"
                                    Margin="0,4,0,60" />

                    <!-- Glyph Key section -->
                    <Expander Header="Glyph Key" IsExpanded="True" Margin="0,0,0,8">
                        <StackPanel Margin="4,8">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,8">
                                <ui:Button x:Name="RecordButton"
                                           Width="120"
                                           Padding="8,6"
                                           Content="Record"
                                           Icon="{ui:SymbolIcon Record24}">
                                    <ui:Button.ToolTip>
                                        <ToolTip Content="Click to record your Glyph key sequence." />
                                    </ui:Button.ToolTip>
                                </ui:Button>
                                <TextBlock x:Name="CurrentGlyphText" Margin="16,0,0,0" Foreground="{DynamicResource TextFillColorSecondaryBrush}" FontSize="12" VerticalAlignment="Center" Text="Glyph Key: (loading...)" />
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!-- Keymaps section -->
                    <Expander Header="Keymaps" IsExpanded="True" Margin="0,0,0,8">
                        <StackPanel Margin="4,8">
                            <ui:Button x:Name="OpenKeymapEditorButton" Content="Open Keymap Editor" Padding="12,8" HorizontalAlignment="Left" Appearance="Primary" Click="OpenKeymapEditorButton_Click" Icon="{ui:SymbolIcon Keyboard24}">
                                <ui:Button.ToolTip>
                                    <ToolTip Content="Open the Keymap Editor to manage keymaps visually." />
                                </ui:Button.ToolTip>
                            </ui:Button>
                        </StackPanel>
                    </Expander>

                    <!-- Overlay section -->
                    <Expander Header="Overlay" IsExpanded="True" Margin="0,0,0,8">
                        <StackPanel Margin="4,8">
                            <TextBlock FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,6" Text="Theme" />
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <ComboBox x:Name="ThemeCombo" Width="200">
                                    <ComboBox.ToolTip>
                                        <ToolTip Content="Select the overlay theme." />
                                    </ComboBox.ToolTip>
                                </ComboBox>
                                <ui:Button x:Name="OpenThemesFolderButton" Margin="8,0,0,0" Padding="8,6" Content="Open Themes Folder" Appearance="Secondary" Icon="{ui:SymbolIcon FolderOpen24}">
                                    <ui:Button.ToolTip>
                                        <ToolTip Content="Open the themes folder in Explorer." />
                                    </ui:Button.ToolTip>
                                </ui:Button>
                            </StackPanel>

                            <CheckBox x:Name="BreadcrumbsModeCheckBox" Margin="0,0,0,8" Content="Enable breadcrumbs mode">
                                <CheckBox.ToolTip>
                                    <ToolTip Content="Show only inline breadcrumbs/hints instead of the full keymap list." />
                                </CheckBox.ToolTip>
                            </CheckBox>

                            <CheckBox x:Name="StartWithWindowsCheckBox" Margin="0,0,0,4" Content="Open Glyph at Windows sign-in">
                                <CheckBox.ToolTip>
                                    <ToolTip Content="Start Glyph automatically when you sign in to Windows (per-user)." />
                                </CheckBox.ToolTip>
                            </CheckBox>
                        </StackPanel>
                    </Expander>

                    <StackPanel HorizontalAlignment="Center" Margin="0,20,0,0">
                        <TextBlock FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" x:Name="VersionText" Text="Version (loading...)" TextAlignment="Center" />
                        <TextBlock FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" TextAlignment="Center" Margin="0,4,0,0">
                            Need help? 
                            <Hyperlink NavigateUri="https://github.com/HasNate618/Glyph" RequestNavigate="Hyperlink_RequestNavigate">
                                https://github.com/HasNate618/Glyph
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>
                    <Border Height="4" />
                </StackPanel>
            </ScrollViewer>
        </ContentControl>
    </Grid>
</ui:FluentWindow>
